# TD作成くん 要件定義書

## 1. プロジェクト概要
- 目的: Google広告ランキングサイト向け広告クリエイティブ（TD）を自動生成する支援エージェントを構築する。
- 背景: 検索結果上のスポンサード広告やSEO上位記事の訴求を収集・分析し、ターゲットとキーワードに最適化したTD案を迅速に提示するニーズがある。

## 2. 入力仕様
- 入力者: 広告運用担当者。
- 入力項目:
  - `target`: 想定ターゲットの属性や課題。
  - `keyword`: Google検索で使用する軸となるキーワード。
  - `site_info`: 人間が配信を想定する自社・提案先サイトの概要（任意／推奨）。
- 入力形式: JSONまたは同等の構造化形式（例: `{ "target": "...", "keyword": "...", "site_info": "..." }`）。

## 3. 出力仕様
- TD案: タイトル、説明文、CTA等を含む複数案（最低2〜3案）。
- 付随情報:
  - 検索意図の要約。
  - スポンサード広告（競合）の訴求整理。
  - SEO上位3記事の要点まとめ。
  - ターゲット課題と訴求軸の整理表。
- 出力形式: JSONまたはスプレッドシート転記を想定した構造化データ。

## 4. 機能要件
1. **検索実行**: 指定キーワードでGoogle検索を自動実行し、SERP（広告・自然検索結果）を取得する。
2. **スポンサード情報抽出**: 広告枠のタイトル、説明文、リンクを取得し、各リンク先の主要訴求ポイントを抽出する。
3. **サイト内情報収集**: 広告リンク先のページをクロールし、商品・サービスの特長や訴求表現を整理する。
4. **SEO記事分析**: 自然検索上位3記事の構成、見出し、主要キーワードを抽出・要約する。
5. **検索意図分析**: 取得データをもとに検索意図（比較検討、情報収集、購入検討など）を分類する。
6. **訴求軸整理**: 価格、信頼性、スピードなどの訴求軸を比較し、ターゲット課題と紐付ける。
7. **TD生成**: ターゲット情報と配信予定サイト情報を踏まえ、Google広告ポリシーに準拠したTD案を生成する。
8. **バリエーション提示**: 少なくとも2〜3案のタイトル・説明文・CTAを生成し、人間が選定・修正できるようにする。
9. **ログ出力**: 取得元URL、抽出データ、生成過程を記録し、後から追跡できる状態にする。

## 5. 非機能要件
- **パフォーマンス**: キーワード1件あたりの処理時間は数分以内を目安とする。
- **再現性**: 同一入力に対し、同等品質の出力を再現できること。
- **信頼性**: 検索・スクレイピング失敗時のリトライ、例外発生時の graceful degradation を実装する。
- **セキュリティ／コンプライアンス**: 利用規約（Googleサービス、対象サイト）を遵守し、必要に応じてAPI利用や適切なヘッダ設定を検討する。
- **保守性**: 新しい取得先やフォーマット追加に対して拡張しやすい設計とする。

## 6. データ取得要件
- Google SERPからのスポンサード広告枠および自然検索結果上位3件の取得。
- 各広告リンク先および自然検索記事のDOM解析・テキスト抽出。
- robot.txtやアクセス制限への配慮、適切なアクセス間隔の設定。
- 必要であればヘッドレスブラウザやSERP APIの利用を検討する。

## 7. 分析ロジック
- 検索意図の分類ロジック定義（例: 情報収集／比較／購入など）。
- 訴求ポイント抽出アルゴリズム（キーワード頻度、強調表現、CTAの分析）。
- SEO記事の構造解析（見出し階層、要点まとめ、FAQなどの抽出）。
- ターゲット情報と取得データのマッピングによる訴求優先度算出。

## 8. TD生成ルール
- **タイトル**: 指定キーワードを含め、ターゲット課題と差別化要素を盛り込む。
- **説明文**: 検索意図に合わせたベネフィット、信頼性訴求、CTAを盛り込む。
- **文字数制限**: Google広告の仕様（タイトル30文字×3、説明文90文字×2等）を考慮する。
- **禁止表現チェック**: 誇大広告や比較優位の断定表現など、ポリシーに抵触する表現を避ける。
- **バリエーション**: 訴求軸やCTAが異なる複数パターンを生成し、A/Bテストに活用できるようにする。

## 9. 運用フロー
1. ターゲット・検索KW・サイト情報を入力。
2. SERPクロールおよびデータ収集。
3. 収集データの整形・分析レポート生成。
4. TD案生成およびバリエーション出力。
5. 人間がレビュー・修正し、最終TDを決定。

## 10. 未確定事項・要確認項目
- Google利用規約への適合法的対応（API利用可否、スクレイピング制限）。
- 代理店／広告主が提供するサイト情報のフォーマット。
- TD納品形式（JSON、スプレッドシート、ドキュメント等）の最終決定。
- 一度に処理するキーワード件数、運用頻度（オンデマンド／バッチ）。
- 自動生成後に人が編集する範囲、最終責任分担。

## 11. 今後の進め方（提案）
1. 要件定義書のレビュー・承認、未確定事項の確定。
2. データ取得手法（API／スクレイピング）、技術スタックの選定。
3. プロトタイプの処理フロー図・シーケンス図の作成。
4. サンプルキーワードでのPoC実施と評価指標の設定。
5. 本実装・テスト・ドキュメント整備。
