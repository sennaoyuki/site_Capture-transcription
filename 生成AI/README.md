# 生成AIセミナー - スポンサード広告抽出プロジェクト

このプロジェクトは、Playwrightを使用してGoogle検索結果から「生成AIセミナー」のスポンサード広告（リスティング広告）を自動抽出するツールです。

## 📁 ファイル構成

```
生成AI/
├── README.md                    # このファイル
├── requirements.txt             # Python依存パッケージ
├── extract_ads.py              # 広告抽出スクリプト
├── sponsored_ads.md            # 抽出された広告一覧（全件）
├── sponsored_ads_unique.md     # 抽出された広告一覧（重複削除版・分析付き）
├── search_result.png           # 検索結果のスクリーンショット
└── page_source.html            # 検索結果ページのHTMLソース
```

## 🚀 使い方

### 1. 依存パッケージのインストール

```bash
pip3 install -r requirements.txt
python3 -m playwright install chromium
```

### 2. スクリプトの実行

```bash
python3 extract_ads.py
```

### 3. 出力ファイルの確認

実行後、以下のファイルが生成されます：
- `sponsored_ads.md` - 全広告データ
- `sponsored_ads_unique.md` - 重複削除版（推奨）
- `search_result.png` - スクリーンショット
- `page_source.html` - HTMLソース

## 📊 抽出結果

### 抽出された広告の種類

1. **展示会・EXPO系**
   - AI・人工知能EXPO（幕張メッセ）

2. **無料セミナー系**
   - 最新生成AIセミナー
   - ChatGPTセミナー

3. **比較・ランキング系**
   - AIセミナー比較サイト
   - 人気セミナーランキング

4. **実績訴求系**
   - 参加者数31万人突破のセミナー

### 主要な訴求ポイント

- 🆓 **無料**: 参加費無料を前面に訴求
- 📊 **実績**: 参加者数などの数値的実績
- 🏢 **公式**: 公式イベントであることの強調
- ⏱️ **手軽さ**: 短時間で学べることをアピール
- 📅 **最新**: 2025年、最新などの時期性

## 🔧 技術仕様

### 使用技術
- **Python 3.12**
- **Playwright 1.48.0** - ブラウザ自動化
- **Chromium** - ヘッドレスブラウザ

### 機能
- ✅ Google検索の自動実行
- ✅ スポンサード広告の自動検出
- ✅ 広告見出しとURLの抽出
- ✅ CAPTCHA検出と待機機能
- ✅ スクリーンショット自動保存
- ✅ HTMLソース保存
- ✅ Markdown形式での出力

### 広告検出方法
スクリプトは複数の方法で広告を検出します：

1. **スポンサーラベル検索**: 「スポンサー」「広告」テキストを含む要素
2. **CSSセレクタ**: Googleの既知の広告コンテナクラス
3. **aria-label属性**: アクセシビリティ属性からの検出

## ⚠️ 注意事項

### CAPTCHA対策
Googleは自動化されたアクセスを検出すると、reCAPTCHAを表示することがあります。スクリプトは以下の対策を実装しています：

- 人間らしいUser-Agent
- 自動化検知の回避設定
- 適切な待機時間
- CAPTCHA検出時の自動待機（30秒）

### 広告表示の変動性
以下の要因により、広告の表示内容は変動します：

- 地域・ロケーション
- 時間帯
- 検索履歴
- デバイスタイプ
- Google広告の入札状況

## 📝 カスタマイズ

### 検索キーワードの変更

`extract_ads.py`の最後の部分を編集：

```python
# 広告を抽出
ads = extract_sponsored_ads("別のキーワード")

# Markdownファイルに保存
md_file = save_to_markdown(ads, "別のキーワード")
```

### 待機時間の調整

ネットワーク環境に応じて、`time.sleep()`の値を調整できます。

## 🔍 トラブルシューティング

### 広告が検出されない場合

1. **CAPTCHA確認**: スクリーンショットでCAPTCHAが表示されていないか確認
2. **待機時間増加**: ページ読み込みの待機時間を増やす
3. **ヘッドレスモード解除**: `headless=False`で実行し、手動で確認

### ブラウザが起動しない場合

```bash
# Chromiumを再インストール
python3 -m playwright install chromium --force
```

## 📄 ライセンス

このツールは教育・研究目的で作成されています。Google利用規約を遵守して使用してください。

## 🙋 お問い合わせ

問題や質問がある場合は、プロジェクト管理者にお問い合わせください。

---

**最終更新**: 2025年10月3日



